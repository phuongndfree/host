var username=$(".userName").html(),user="";username&&(user=username.split("@")[0]);function backingScale(){}function preview(a,b,c){}function candlestick(a,b,c,d,h,e,g,f,k,l,x,t,p,y,q){}function depthChart(a,b,c){}function hideAllToolPanels(){}function restoreTrollboxSettingsFromStorage(a){}function trace(a){}function doubleToString(a){}function saveExchangeSettings(){}function saveNonStarredMarket(a,b){}function restoreSettingsFromStorage(a){}function loadExchangeSettings(){}
function initMarketBox(){}function initBigChart(){}function initStopLimits(){}function initBookControls(){}function initMarketDepth(){}function initTradeHistory(){}function initNonMarketTables(){}function initEscToolpanels(){}function writeMyTradesTable(a){}function refreshMyTrades(){}function writeTradeHistoryTable(a){}function refreshTradeHistory(){}function orderBookClick(a,b){}function loadFullOrderbook(a){}function writeBuySellOrdersTable(a,b){}function reinitOrderbookPane(a){}
function executeReinits(){}function refreshDepthChart(){}function refreshOrderBook_br(){}function refreshOrderBook_quick(){}function init3ColActions(){}function updateStopLimitTotal(){}function updateSellTotal(){}function updateBuyTotal(){}function webSocketCall(a,b){}function cancelOrder(a){}function cancelTriggerOrder(a){}function myOpenOrdersRow(a){}function writeMyOpenOrdersTable(a){}function initTradeHistoryButtons(){}function updateTickerBalances(){}function updatePrivateInfo(){}
function updateMarketDisplay(){}function hardRefreshTicker(){}function drawFullMarket(){}function setBookUIstate(){}function refreshAll(){}function initClicks(){}function evaluateHash(a){}function initHashChanges(){}function tickerEvent(a,b){}function resetOrderBookCache(){}function changeOrderBookPrecision(a){}function setMinPrecision(){}function fixRate(a,b){}function cacheOrder(a,b,c,d){}function uncacheOrder(a,b){}function orderBookRow(a,b){}function updateTotals(a,b,c){}
function insertOrder(a,b,c){}function sumOrderRow(a,b){}function updateOrder(a,b){}function asc(a,b){}function desc(a,b){}function removeOrder(a,b){}function marketEvent(a,b){}function processMarketQueue(){}function processMarketEvent(a){}function alertEvent(a,b){}function heartbeatEvent(a,b){}function footerEvent(a,b){}function userEvent(a,b){}function unsubscribe(a,b){}function unsubscribeAll(){}function startOrderBook(){}function initWebSockets_new(){}function initWebSockets(a){}
function resetWebsocket(a){}function completelyResetWebsocket(){}function checkHeartbeat(){}function checkAllJSLoaded(){}function submitStopLimitOrder(){}function closeMarginPosition(a){}function executeCloseMarginPosition(a){}function pauseUpdates(){}function resumeUpdates(){}function blur(){}function focus(){}function setOrderBookUpdateInterval(a){}function hideChartLoading(){}function updateChartHighLow(a,b){}function chartSnapZoom(a){}function changeCandlestickZoom(a,b){}
function getChartWidth(){}function refreshChart(){}function changeChartType(a){}function setCurrentCandlestickButton(){}function refreshCandleSticksFirst(){}function refreshCandleSticks(){}function deactivateCurrentZoomButton(){}function initPreview(){}function initChartToolPanel(){}function updateChartCanvasWidth(){}function resizeCharts(){}function initChartMouseover(){}function initCharts_br_js(){}function exactRound(a,b){}function getCurrentPairDetails(){}
function setCurrentMarketRowActive(){}function clickMarketTableRow(a){}function activateMarketTableClicks(){}function filterNonStarred(){}function clearMarketSearch(){}function setFilterMessage(){}function resetMatketTableHeights(){}function getName(a){}function formatTickerData(a,b){}function getRow(a){}function writeMarketTable(a){}function initMarketTables(){}function showMarketLines(a){}function showMarketColumn(a,b,c){}function quickSelectStars(a,b){}function toggleStar(a){}
function getTickerInfo(){}var formatMoney=function(a,b,c,d){b=isNaN(b=Math.abs(b))?2:b;c=void 0==c?".":c;d=void 0==d?",":d;var h=0>a?"-":"",e=String(parseInt(a=Math.abs(Number(a)||0).toFixed(b))),g=3<(g=e.length)?g%3:0;return h+(g?e.substr(0,g)+d:"")+e.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(b?c+Math.abs(a-e).toFixed(b).slice(2):"")};
function clearPolo(){for(var a=setTimeout(";"),b=setInterval(";"),c=0;c<a;c++)clearTimeout(c);for(c=0;c<b;c++)clearInterval(c);document.open();document.close();window.conn.close();setTimeout(function(){startAuto()},1E3)}var _localSetting=localStorage.getItem("setting");function updateSetting(a){localStorage.setItem("setting",JSON.stringify(a))}
for(var candels={},listCurrencyPair="BTC_ETH BTC_LTC BTC_BCH BTC_XRP BTC_DASH BTC_ZEC BTC_GAS BTC_XMR BTC_CLAM BTC_BTS BTC_ETC BTC_SYS BTC_LSK BTC_STR BTC_OMG ETH_ZEC ETH_BCH ETH_OMG ETH_GAS ETH_ETC USDT_BTC USDT_ETH USDT_LTC USDT_BCH USDT_ZEC USDT_XRP USDT_ETC USDT_DASH USDT_XMR USDT_NXT USDT_STR USDT_REP".split(" "),lengthListCurrencyPair=listCurrencyPair.length,i=0;i<lengthListCurrencyPair;i++)candels[listCurrencyPair[i]]=[],allTickerData[listCurrencyPair[i]].choSongKhac=!1;
var countProcess=0,timeProcess,nameProcess="";timeProcess=setInterval(function(){var a=Math.round(countProcess/(3*lengthListCurrencyPair+1)*100)+"%";$(".process").css("width",a);$(".process .percent").html("Loading "+nameProcess+" "+a)},1E3);var setting={autoTrade:[],oldOrder:{}},volumeTradeHistory={},turnApp=!0,reloadPage=!1,countInitTradeHistory=0,timeoutRequest=500,abortTradeHistory,timePingSocket;
function initTradeHistory(){nameProcess="trade history";var a=listCurrencyPair[countInitTradeHistory];abortTradeHistory=$.ajax({url:public_url,type:"GET",timeout:1E4,data:{command:"returnTradeHistory",depth:9999999,currencyPair:a},success:function(b){volumeTradeHistory[a]=b;countProcess+=1;countInitTradeHistory+=1;countInitTradeHistory<lengthListCurrencyPair?setTimeout(function(){initTradeHistory()},timeoutRequest):!reloadPage&&countInitTradeHistory>=lengthListCurrencyPair&&initOrderBook()},error:function(a){setTimeout(function(){console.log("\nLoad error",
nameProcess,"trying again!");initTradeHistory()},5E3)}})}function abortInitTradeHistory(){countInitTradeHistory=0;abortTradeHistory.abort();initTradeHistory();countProcess=0}var countInitOrderBook=0,volumeOrderBook={},abortOrderBook;
function initOrderBook(){nameProcess="order book";var a=listCurrencyPair[countInitOrderBook];reloadPage&&"0"!==$("#marketCurrency #"+a+" .wallBuy").text()&&"0"!==$("#marketCurrency #"+a+" .wallSell").text()?(countInitOrderBook+=1,countInitOrderBook<lengthListCurrencyPair?setTimeout(function(){initOrderBook()},timeoutRequest):!reloadPage&&countInitOrderBook>=lengthListCurrencyPair?initBalance():reloadPage&&loadOrderBook()):abortOrderBook=$.ajax({url:public_url,type:"GET",data:{command:"returnOrderBook",
currencyPair:a},timeout:1E4,success:function(b){volumeOrderBook[a]=b;countProcess+=1;countInitOrderBook+=1;countInitOrderBook<lengthListCurrencyPair?setTimeout(function(){initOrderBook()},timeoutRequest):!reloadPage&&countInitOrderBook>=lengthListCurrencyPair?initBalance():reloadPage&&loadOrderBook()},error:function(a){setTimeout(function(){console.log("\nLoad error",nameProcess,"trying again!");initOrderBook()},5E3)}})}
function abortInitOrderBook(){countInitOrderBook=0;abortOrderBook.abort();initOrderBook();countProcess=lengthListCurrencyPair/3}var myBalance;
function initBalance(){nameProcess="balances";$.ajax({url:"https://poloniex.com/private",type:"POST",data:{command:"returnPrivateInfoJSON",currencyPair:"USDT_BTC"},success:function(a){try{a=JSON.parse(a),a.balances&&(myBalance=a.balances.balances,countProcess+=1,initAllMyOrder()),estimated(a.balances)}catch(b){alert("Vui l\u00f2ng \u0111\u0103ng nh\u1eadp"),window.location.href="https://poloniex.com/login"}},error:function(a){setTimeout(function(){console.log("\nLoad error",nameProcess,"trying again!");
initBalance()},5E3)}})}var estimatedBTC=0,estimatedUSD=0;function estimated(a){estimatedUSD=estimatedBTC=0;var b=a.btcValues,c;for(c in b)estimatedBTC+=parseFloat(b[c]);b=parseFloat(allTickerData.USDT_BTC.last);estimatedBTC+=(parseFloat(a.balances.USDT)+parseFloat(a.onOrders.USDT))/b;estimatedUSD=estimatedBTC*b;reloadPage&&($(".totalBTC").html(formatMoney(estimatedBTC,4)),$(".totalUSD").html(formatMoney(estimatedUSD)))}
function appendBalance(a){var b=myBalance[a];"BTC"===a?$(".balancebtc").html(parseFloat(b).toFixed(4)):"ETH"===a?$(".balanceeth").html(parseFloat(b).toFixed(4)):"XMR"===a?$(".balancexmr").html(parseFloat(b).toFixed(4)):"USDT"===a&&$(".balanceusdt").html(parseFloat(b).toFixed(4));$("#marketCurrency #BTC_"+a+" .balance").html(b);$("#marketCurrency #ETH_"+a+" .balance").html(b);$("#marketCurrency #XMR_"+a+" .balance").html(b);$("#marketCurrency #USDT_"+a+" .balance").html(b)}var countAllMyOrder=0;
function initAllMyOrder(){nameProcess="open orders";var a=listCurrencyPair[countAllMyOrder];$.ajax({url:"https://poloniex.com/private",type:"POST",timeout:1E4,data:{command:"returnPrivateInfoJSON",currencyPair:a},success:function(b){b=JSON.parse(b);allTickerData[a].openOrders=b.openOrders.limit;countProcess+=1;countAllMyOrder+=1;countAllMyOrder<lengthListCurrencyPair?setTimeout(function(){initAllMyOrder()},timeoutRequest):(myBalance=b.balances.balances,clearPolo())},error:function(){setTimeout(function(){console.log("\nLoad error",
nameProcess,"trying again!");initAllMyOrder()},5E3)}})}function abortInitAllMyOrder(){countAllMyOrder=0;initAllMyOrder();countProcess=lengthListCurrencyPair/2-1}function loadMyOrder(){for(var a=0;a<listCurrencyPair.length;a++){var b=listCurrencyPair[a],c="";allTickerData[b].openOrders&&0<allTickerData[b].openOrders.length&&(c="buy"===allTickerData[b].openOrders[0].type?"<b class='green'>Buy</b>":"<b class='red'>Sell</b>");$("#marketCurrency #"+b+" .order").html(c)}}
function getMyOrder(a){$.ajax({url:"https://poloniex.com/private",type:"POST",data:{command:"returnPrivateInfoJSON",currencyPair:a},success:function(b){try{b=JSON.parse(b);if(b.openOrders){allTickerData[a].openOrders=b.openOrders.limit;myBalance=b.balances.balances;var c=a.split("_");appendBalance(c[0]);appendBalance(c[1]);c="";allTickerData[a].openOrders&&0<allTickerData[a].openOrders.length&&(c="buy"===allTickerData[a].openOrders[0].type?"<b class='green'>Buy</b>":"<b class='red'>Sell</b>");$("#marketCurrency #"+
a+" .order").html(c);appendBalance(a.split("_")[0])}estimated(b.balances)}catch(d){console.log(b)}}})}
function formOrder(a,b,c,d){d=parseFloat(d);0<d&&($("#marketCurrency #"+b+" .order").html("<img src='https://smartas.vn/content/images/loading.gif' style='height:20px'/>"),$.ajax({url:"/private.php",type:"POST",timeout:1E4,data:{currencyPair:b,rate:c,amount:d,command:a},success:function(h){console.log("\n ["+a.toUpperCase()+"] "+b+": price "+c.toFixed(8)+" amount "+d.toFixed(8));getMyOrder(b)},error:function(c){console.log(a.toUpperCase(),"error",b,":\n",c)}}))}
function huyOrder(a,b){if(allTickerData[a].openOrders&&0<allTickerData[a].openOrders.length){$("#marketCurrency #"+a+" .order").html("<img src='https://smartas.vn/content/images/loading.gif' style='height:20px'/>");for(var c=0;c<allTickerData[a].openOrders.length;c++)allTickerData[a].openOrders[c].type===b&&$.ajax({url:"/private.php",type:"POST",timeout:1E4,data:{command:"cancelOrder",currencyPair:a,orderNumber:allTickerData[a].openOrders[c].orderID},success:function(c){c=JSON.parse(c);1==c.success?
console.log("\n ["+b.toUpperCase()+"] "+a+": cancel order"):console.log(c.error);getMyOrder(a)}})}}function cancelPerOrder(a,b){$.ajax({url:"/private.php",type:"POST",async:!1,data:{command:"cancelOrder",currencyPair:a,orderNumber:b},success:function(b){b=JSON.parse(b);1!=b.success&&alert(b.error);getMyOrder(a);$("#myModal").modal("hide")}})}function sentTelegram(a,b){$.ajax({url:"https://smartas.vn/api/API_Telegram",type:"POST",data:{user:a,ms:"["+a.split("@")[0]+"] "+b}})}
function getMyTrade(a){var b;$.ajax({url:"https://poloniex.com/private",type:"POST",async:!1,data:{command:"returnUserTradeHistoryJSON",currencyPair:a},success:function(a){b=JSON.parse(a)},error:function(){alert("Please login!")}});return b}var timeAppendOrderbook;function intervalAppendData(){timeAppendOrderbook=setInterval(function(){for(var a=0;a<lengthListCurrencyPair;a++)appendOrderbook(listCurrencyPair[a]),appendVolumeBuySell(listCurrencyPair[a])},1E4)}var countListAutoTrade=0;
function autoTradeAll(){if(turnApp&&0<setting.autoTrade.length){var a=setting.autoTrade[countListAutoTrade];$("#marketCurrency #"+a+" .autoTrade").is(":checked")?(getMyOrder(a),autoTrade(a),$(".running").html(a)):(huyOrder(a,"buy"),huyOrder(a,"sell"));countListAutoTrade+=1;if(countListAutoTrade>=setting.autoTrade.length)for(a=countListAutoTrade=0;a<lengthListCurrencyPair;a++)appendOrderbook(listCurrencyPair[a])}else $(".running").html(". . .");a=3E3;5<=setting.autoTrade.length?a=2E3:10<=setting.autoTrade.length&&
(a=1E3);setTimeout(function(){autoTradeAll()},a)}
function setLocalBuyWall(a,b,c,d,h,e){try{b&&(setting.oldOrder[a].priceBuy=b),c&&(setting.oldOrder[a].priceSell=c),e&&(setting.oldOrder[a].lastProfit=e),setting.oldOrder[a].buyStatus=d,setting.oldOrder[a].sellStatus=h}catch(g){setting.oldOrder||(setting.oldOrder={}),setting.oldOrder[a]={},b&&(setting.oldOrder[a].priceBuy=b),c&&(setting.oldOrder[a].priceSell=c),e&&(setting.oldOrder[a].lastProfit=e),setting.oldOrder[a].buyStatus=d,setting.oldOrder[a].sellStatus=h}updateSetting(setting)}
var minBuy=10,minSell=10;
function autoTrade(a){try{if(turnApp&&-1<setting.autoTrade.indexOf(a)){var b=$(".placeBet").val();b||(b=50,$(".placeBet").val(b));b=parseFloat(b);var c=parseFloat(allTickerData[a].last),d="",h=a.split("_"),e=b;"BTC"===h[0]?(minBuy=.002,e=b/allTickerData.USDT_BTC.last):"ETH"===h[0]?e=b/allTickerData.USDT_ETH.last:"XMR"===h[0]&&(e=b/allTickerData.USDT_XMR.last);minSell=minBuy/c;var g=parseFloat(myBalance[h[0]]);g<e&&(e=g);var f=parseFloat(myBalance[h[1]]),k=!1,l=!1,x=0,t=0;if(allTickerData[a].openOrders)for(var p=
0;p<allTickerData[a].openOrders.length;p++){var y=allTickerData[a].openOrders[p].type;"buy"===y?(k=!0,x=parseFloat(allTickerData[a].openOrders[p].rate)):"sell"===y&&(l=!0,t=parseFloat(allTickerData[a].openOrders[p].rate),huyOrder(a,"buy"),k=!1,setting.oldOrder&&setting.oldOrder[a]&&(setting.oldOrder[a].buyStatus=!0))}var q=allTickerData[a].wallBuy.price,z=allTickerData[a].wallSell.price,B=allTickerData[a].wallBuy.percentWall,C=allTickerData[a].wallSell.percentWall,u=300*parseInt((new Date).getTime()/
1E3/300)-1200;0<candels[a].length&&candels[a][0].date!==u?$.ajax({url:"https://poloniex.com/public?command=returnChartData&currencyPair="+a+"&start="+u+"&end=9999999999&period=300",async:!1,success:function(b){candels[a]=b}}):0===candels[a].length&&$.ajax({url:"https://poloniex.com/public?command=returnChartData&currencyPair="+a+"&start="+u+"&end=9999999999&period=300",async:!1,success:function(b){candels[a]=b}});var v=candels[a],r=v[v.length-1],m=v[v.length-2];r.close=c;var D=m.open,I=m.close;m.open>
m.close&&(D=m.close,I=m.open);y=.999>D/I;b=!1;setting.oldOrder&&setting.oldOrder[a]&&!0===setting.oldOrder[a].buyStatus&&(b=!0);var E=u=v=!1;if($(".activeMA").is(":checked")&&setting.MovingAverage){if(_localMA=setting.MovingAverage.MA10)if(E=!0,6E5>(new Date).getTime()-_localMA.exp){for(p=0;p<$(".activeMA").length;p++)if($(".activeMA").eq(p).is(":checked")){var P=$(".activeMA").eq(p).attr("id");if(-1<_localMA.data[a][P].TypeEMA.indexOf("buy"))v=!0;else{v=!1;break}}u=$("#M30").is(":checked")?-1<_localMA.data[a].M30.TypeEMA.indexOf("sell")?
!0:!1:!0}}else $(".activeMA").is(":checked")||(E=u=v=!0);if(!b&&(g>minBuy||k)&&f<minSell)if(E&&v)if(10>100*allTickerData[a].percentChange){g=function(){if(k){if(A>1.002*x||A<.998*x)huyOrder(a,"buy"),formOrder("buy",a,A,F),setLocalBuyWall(a,A,"",!1,!0,"")}else formOrder("buy",a,A,F),setLocalBuyWall(a,A,"",!1,!0,"")};var J=.995>m.low/D,L=(m.close+m.open)/2,Q=r.open>L,F=e/c,A=.985*c;if(r.close>r.open&&r.close>m.close)if(J||Q&&y)if(!1===allTickerData[a].choSongKhac)if(0<=q)if(e=B+C,.4<=e){var n=parseFloat(B.toFixed(2));
q*=1.0002;.2>=n?(k?x<q&&(huyOrder(a,"buy"),formOrder("buy",a,q,F),setLocalBuyWall(a,q,"",!1,!0,"")):(formOrder("buy",a,q,F),setLocalBuyWall(a,q,"",!1,!0,"")),d='<b class="green">\u0110ang mua</b>'):(d=.5<n?"T\u01b0\u1eddng mua l\u00f9i l\u1ea1i":"Xu h\u01b0\u1edbng kh\u00f4ng x\u00e1c \u0111\u1ecbnh",g())}else-.1>e?d='<b class="red">L\u1ed7i</b>':(d="T\u01b0\u1eddng h\u1eb9p",g());else d="Kh\u00f4ng c\u00f3 t\u01b0\u1eddng mua",huyOrder(a,"buy");else d="\u0110ang ch\u1edd s\u00f3ng kh\u00e1c",g();
else d="\u0110ang x\u00e1c t\u00edn hi\u1ec7u",g();else d="Gi\u00e1 \u0111ang gi\u1ea3m",allTickerData[a].choSongKhac=!1,g()}else d="\u0110ang \u1edf \u0111\u1ec9nh",huyOrder(a,"buy");else d=E?"Xu h\u01b0\u1edbng \u0111ang xu\u1ed1ng":"Ch\u1edd kh\u1edfi \u0111\u1ed9ng",huyOrder(a,"buy");else f>minSell?(d="<b class='green'>\u0110\u00e3 mua</b>",huyOrder(a,"buy"),b||(reloadPage&&setting.oldOrder&&setting.oldOrder[a]&&sentTelegram(username,a+": \u0110\u00e3 mua gi\u00e1 "+setting.oldOrder[a].priceBuy.toFixed(8)),
setLocalBuyWall(a,"","",!0,!1,"")),b=!0):d=g<minBuy?"H\u1ebft money":"H\u1ebft Coin";n=0;if(b)if(f>minSell||l){e=function(){if(l){if(w>1.002*t||w<.998*t)huyOrder(a,"sell"),formOrder("sell",a,w,f),G=(w-setting.oldOrder[a].priceBuy)/setting.oldOrder[a].priceBuy*100,setLocalBuyWall(a,"",w,!0,!1,G)}else formOrder("sell",a,w,f),G=(w-setting.oldOrder[a].priceBuy)/setting.oldOrder[a].priceBuy*100,setLocalBuyWall(a,"",w,!0,!1,G)};var M=parseFloat($(".takeWP").val()),R=parseFloat($("#marketCurrency #"+a+" .takePP").val()),
N=parseFloat($("#marketCurrency #"+a+" .stopLoss").val());J=.995>I/m.high;var S=D>1.002*r.open,T=r.high>=m.high&&r.low<=m.low;if(!setting.oldOrder[a].priceBuy){var K=getMyTrade(a);setting.oldOrder[a].priceBuy=0===K.length||"sell"===K[0].type?c:parseFloat(K[0].rate);updateSetting(setting)}m=c;m<setting.oldOrder[a].priceBuy&&(m=setting.oldOrder[a].priceBuy);n=(c-setting.oldOrder[a].priceBuy)/setting.oldOrder[a].priceBuy*100;var H=(z-setting.oldOrder[a].priceBuy)/setting.oldOrder[a].priceBuy*100,w=1.01*
m;1<n&&(w=1.005*m);var G=0;q||y||J||S||T||r.close<L?r.close<r.open?0>=q&&u||n>R||n<N&&.9<B&&u||n<N&&.6<B&&.1>C&&u?(l?t!==c&&(huyOrder(a,"sell"),formOrder("sell",a,c,f),setLocalBuyWall(a,"",c,!0,!1,n)):(formOrder("sell",a,c,f),setLocalBuyWall(a,"",c,!0,!1,n)),d="\u0110ang b\u00e1n k\u1ef3 v\u1ecdng"):.2>=C?H>=M?(l?t>z&&(huyOrder(a,"sell"),formOrder("sell",a,z,f),setLocalBuyWall(a,"",z,!0,!1,H)):(formOrder("sell",a,z,f),setLocalBuyWall(a,"",z,!0,!1,H)),d="<b class='red'>\u0110ang b\u00e1n</b>"):(d=
H<M?"Chu\u1ea9n b\u1ecb b\u00e1n":"\u0110ang x\u00e1c \u0111\u1ecbnh",e()):(d=.6<C?"T\u01b0\u1eddng b\u00e1n l\u00f9i l\u1ea1i":"\u0110ang x\u00e1c \u0111\u1ecbnh t\u01b0\u1eddng",e()):(d="Gi\u00e1 \u0111ang l\u00ean",e()):(d="Th\u00e2n n\u1ebfn ch\u01b0a x\u00e1c \u0111\u1ecbnh",e())}else huyOrder(a,"sell"),d="Ch\u1ed1t l\u00e3i",0>=setting.oldOrder[a].lastProfit&&(d="C\u1eaft l\u1ed7"),setTimeout(function(){parseFloat(myBalance[h[1]])<minSell&&-3<setting.oldOrder[a].lastProfit&&sentTelegram(username,
a+": "+d+" gi\u00e1 "+setting.oldOrder[a].priceSell.toFixed(8)+" "+formatMoney(setting.oldOrder[a].lastProfit)+"%")},3E4),setLocalBuyWall(a,"","",!1,!0,""),setting.oldOrder[a].totalProfit=setting.oldOrder[a].totalProfit?setting.oldOrder[a].totalProfit+(setting.oldOrder[a].lastProfit-.3):setting.oldOrder[a].lastProfit-.3,c="",0<setting.oldOrder[a].totalProfit?c='<b class="green">'+setting.oldOrder[a].totalProfit.toFixed(2)+"%</b>":0>setting.oldOrder[a].totalProfit&&(c='<b class="red">'+setting.oldOrder[a].totalProfit.toFixed(2)+
"%</b>"),$("#marketCurrency #"+a+" .totalProfit").html(c),updateSetting(setting),allTickerData[a].choSongKhac=!0;b?($("#marketCurrency #"+a+" .status").html(d),c="0%",c=0<n?"<span class='green'>"+n.toFixed(2)+"%</span>":"<span class='red'>"+n.toFixed(2)+"%</span>",$("#marketCurrency #"+a+" .currentProfit").html(c)):$("#marketCurrency #"+a+" .status").html(d)}}catch(O){console.log("\nError auto trade: "+a,"\n"+O)}}
function loadHistoryTrade(){for(var a=0;a<listCurrencyPair.length;a++)appendVolumeBuySell(listCurrencyPair[a])}
function appendVolumeBuySell(a){if(0<$("#marketCurrency #"+a).length){parseFloat($("#marketCurrency #"+a+" .price").html().replace(",",""));for(var b=0,c=0,d=parseInt($(".volumeRange").val()),h=0;h<volumeTradeHistory[a].length;h++){var e=volumeTradeHistory[a][h];0===h&&(timeEnd=new Date(e.date),timeEnd.setMinutes(timeEnd.getMinutes()-d),timeEnd=timeEnd.getTime());if((new Date(e.date)).getTime()>=timeEnd)"sell"===e.type?c+=parseFloat(e.total):b+=parseFloat(e.total);else break}1<b?$("#marketCurrency #"+
a+" .volumeBuy").html(formatMoney(b,3)):$("#marketCurrency #"+a+" .volumeBuy").html(b.toFixed(8));1<c?$("#marketCurrency #"+a+" .volumeSell").html(formatMoney(c,3)):$("#marketCurrency #"+a+" .volumeSell").html(c.toFixed(8))}}function loadOrderBook(){for(var a=0;a<listCurrencyPair.length;a++)appendOrderbook(listCurrencyPair[a])}
function appendOrderbook(a){var b=$("#marketCurrency #"+a+" .wallRange").val();if(!b||0>=b)b=2E3,$("#marketCurrency #"+a+" .wallRange").val(b);b=parseInt(b);var c=a.split("_")[0];"BTC"===c?b/=allTickerData.USDT_BTC.last:"ETH"===c?b/=allTickerData.USDT_ETH.last:"XMR"===c&&(b/=allTickerData.USDT_XMR.last);c=allTickerData[a];b/=c.last;var d=!1,h=!1;allTickerData[a].wallBuy={};allTickerData[a].wallSell={};for(var e=0;e<volumeOrderBook[a].bids.length;e++){var g=volumeOrderBook[a].bids[e],f=parseFloat(g[1]);
if(!(f<b)){d=parseFloat(g[0]);e=(c.last-d)/c.last*100;allTickerData[a].wallBuy.price=d;allTickerData[a].wallBuy.amount=f;allTickerData[a].wallBuy.percentWall=e;$("#marketCurrency #"+a+" .wallBuy").html(formatMoney(f*d,3)+" ("+formatMoney(Math.abs(e),2)+"%)").attr("title","Price: "+d);d=!0;break}}d||(allTickerData[a].wallBuy.price=0,allTickerData[a].wallBuy.amount=0,allTickerData[a].wallBuy.percentWall=0,$("#marketCurrency #"+a+" .wallBuy").html("0"));for(e=0;e<volumeOrderBook[a].asks.length;e++)if(g=
volumeOrderBook[a].asks[e],f=parseFloat(g[1]),!(f<b)){d=parseFloat(g[0]);e=(d-c.last)/c.last*100;allTickerData[a].wallSell.price=d;allTickerData[a].wallSell.amount=f;allTickerData[a].wallSell.percentWall=e;$("#marketCurrency #"+a+" .wallSell").html(formatMoney(f*d,3)+" ("+formatMoney(Math.abs(e),2)+"%)").attr("title","Price: "+d);h=!0;break}h||(allTickerData[a].wallSell.price=0,allTickerData[a].wallSell.amount=0,allTickerData[a].wallSell.percentWall=0,$("#marketCurrency #"+a+" .wallSell").html("0"))}
function appendMovingAverage(a){try{if(a){var b=a.M5.TypeEMA.replace(/<(?:.|\n)*?>/gm,""),c=a.M15.TypeEMA.replace(/<(?:.|\n)*?>/gm,""),d=a.M30.TypeEMA.replace(/<(?:.|\n)*?>/gm,""),h=a.H2.TypeEMA.replace(/<(?:.|\n)*?>/gm,""),e=a.H4.TypeEMA.replace(/<(?:.|\n)*?>/gm,""),g="",f="",k="",l="";switch(b){case "L\u00ean":g="#00bf00";break;case "L\u00ean nh\u1eb9":g="#56ff56";break;case "Ch\u01b0a c\u00f3 bi\u1ebfn \u0111\u1ed9ng":g="#ccc";break;case "Bi\u1ebfn \u0111\u1ed9ng nh\u1eb9":g="#999";break;case "Xu\u1ed1ng nh\u1eb9":g=
"#ffaaaa";break;case "Xu\u1ed1ng":g="#ff0000";break;case "Xu\u1ed1ng m\u1ea1nh":g="red";break;case "C\u1eaft l\u00ean":g="#00ffff";break;case "C\u1eaft xu\u1ed1ng":g="#ffaaff";break;case "C\u1eaft xu\u1ed1ng m\u1ea1nh":g="#960018";break;case "\u0110ang xu\u1ed1ng l\u1ea1i":g="#ff6767";break;case "\u0110ang l\u00ean l\u1ea1i":g="#d4ffaa"}switch(c){case "L\u00ean":f="#00bf00";break;case "L\u00ean nh\u1eb9":f="#56ff56";break;case "Ch\u01b0a c\u00f3 bi\u1ebfn \u0111\u1ed9ng":f="#ccc";break;case "Bi\u1ebfn \u0111\u1ed9ng nh\u1eb9":f=
"#999";break;case "Xu\u1ed1ng nh\u1eb9":f="#ffaaaa";break;case "Xu\u1ed1ng":f="#ff0000";break;case "Xu\u1ed1ng m\u1ea1nh":f="red";break;case "C\u1eaft l\u00ean":f="#00ffff";break;case "C\u1eaft xu\u1ed1ng":f="#ffaaff";break;case "C\u1eaft xu\u1ed1ng m\u1ea1nh":f="#960018";break;case "\u0110ang xu\u1ed1ng l\u1ea1i":f="#ff6767";break;case "\u0110ang l\u00ean l\u1ea1i":f="#d4ffaa"}switch(d){case "L\u00ean":k="#00bf00";break;case "L\u00ean nh\u1eb9":k="#56ff56";break;case "Ch\u01b0a c\u00f3 bi\u1ebfn \u0111\u1ed9ng":k=
"#ccc";break;case "Bi\u1ebfn \u0111\u1ed9ng nh\u1eb9":k="#999";break;case "Xu\u1ed1ng nh\u1eb9":k="#ffaaaa";break;case "Xu\u1ed1ng":k="#ff0000";break;case "Xu\u1ed1ng m\u1ea1nh":k="red";break;case "C\u1eaft l\u00ean":k="#00ffff";break;case "C\u1eaft xu\u1ed1ng":k="#ffaaff";break;case "C\u1eaft xu\u1ed1ng m\u1ea1nh":k="#960018";break;case "\u0110ang xu\u1ed1ng l\u1ea1i":k="#ff6767";break;case "\u0110ang l\u00ean l\u1ea1i":k="#d4ffaa"}switch(h){case "L\u00ean":l="#00bf00";break;case "L\u00ean nh\u1eb9":l=
"#56ff56";break;case "Ch\u01b0a c\u00f3 bi\u1ebfn \u0111\u1ed9ng":l="#ccc";break;case "Xu\u1ed1ng nh\u1eb9":l="#ffaaaa";break;case "Bi\u1ebfn \u0111\u1ed9ng nh\u1eb9":l="#999";break;case "Xu\u1ed1ng":l="#ff0000";break;case "Xu\u1ed1ng m\u1ea1nh":l="red";break;case "C\u1eaft l\u00ean":l="#00ffff";break;case "C\u1eaft xu\u1ed1ng":l="#ffaaff";break;case "C\u1eaft xu\u1ed1ng m\u1ea1nh":l="#960018";break;case "\u0110ang xu\u1ed1ng l\u1ea1i":l="#ff6767";break;case "\u0110ang l\u00ean l\u1ea1i":l="#d4ffaa"}switch(e){case "L\u00ean":colorH4=
"#00bf00";break;case "L\u00ean nh\u1eb9":colorH4="#56ff56";break;case "Ch\u01b0a c\u00f3 bi\u1ebfn \u0111\u1ed9ng":colorH4="#ccc";break;case "Bi\u1ebfn \u0111\u1ed9ng nh\u1eb9":colorH4="#999";break;case "Xu\u1ed1ng nh\u1eb9":colorH4="#ffaaaa";break;case "Xu\u1ed1ng":colorH4="#ff0000";break;case "Xu\u1ed1ng m\u1ea1nh":colorH4="red";break;case "C\u1eaft l\u00ean":colorH4="#00ffff";break;case "C\u1eaft xu\u1ed1ng":colorH4="#ffaaff";break;case "C\u1eaft xu\u1ed1ng m\u1ea1nh":colorH4="#960018";break;case "\u0110ang xu\u1ed1ng l\u1ea1i":colorH4=
"#ff6767";break;case "\u0110ang l\u00ean l\u1ea1i":colorH4="#d4ffaa"}$("#marketCurrency #"+a.Pair+" .ma"+a.Range+"M5").css("background",g).attr("title","MA"+a.Range+" - M5: "+b+" - Price: "+a.M5.EmaEntry.toFixed(8));$("#marketCurrency #"+a.Pair+" .ma"+a.Range+"M15").css("background",f).attr("title","MA"+a.Range+" - M15: "+c+" - Price: "+a.M15.EmaEntry.toFixed(8));$("#marketCurrency #"+a.Pair+" .ma"+a.Range+"M30").css("background",k).attr("title","MA"+a.Range+" - M30: "+d+" - Price: "+a.M30.EmaEntry.toFixed(8));
$("#marketCurrency #"+a.Pair+" .ma"+a.Range+"H2").css("background",l).attr("title","MA"+a.Range+" - H2: "+h+" - Price: "+a.H2.EmaEntry.toFixed(8));$("#marketCurrency #"+a.Pair+" .ma"+a.Range+"H4").css("background",colorH4).attr("title","MA"+a.Range+" - H4: "+e+" - Price: "+a.H4.EmaEntry.toFixed(8))}}catch(x){console.log(a)}}
function tradingview(a){a=a.split("_");a=a[1]+a[0];$(".chartTradingView").html('<iframe style="width:100%; height: 300px;" frameborder="0" src="https://www.tradingview.com/widgetembed/?symbol=POLONIEX:'+a+'&interval=5&hidesidetoolbar=0&symboledit=1&saveimage=0&toolbarbg=f1f3f6&studies=ZigZag@tv-basicstudies%1FBB@tv-basicstudies%1FMASimple@tv-basicstudies&hideideas=1&theme=White&style=1&timezone=Asia%2FBangkok&studies_overrides=%7B%7D&overrides=%7B%7D&enabled_features=%5B%5D&disabled_features=%5B%5D&locale=vi_VN&utm_source=www.tradingview.com&utm_medium=widget&utm_campaign=chart"></iframe>')}
var timeSocketPolo;
function openSocket(){clearTimeout(timeSocketPolo);window.connect=new WebSocket("wss://api2.poloniex.com");window.connect.onopen=function(a){for(var b=0;b<listCurrencyPair.length;b++)webSockets_subscribe(listCurrencyPair[b],a.target);webSockets_subscribe(1002,a.target)};window.connect.subscriptions={};window.connect.onmessage=function(a){var b=JSON.parse(a.data);if(1==b[1])return a.target.subscriptions[b[0]]=!0;if("error"in b)return console.log(b);if(0===b[1])return delete a.target.subscriptions[b[0]];if(1002===
b[0]){if(a=markets.byID[b[2][0]].currencyPair,0<$("#marketCurrency #"+a).length){var c=parseFloat($("#marketCurrency #"+a+" .price").html().replace(",",""));currentPrice=parseFloat(b[2][1]);allTickerData[a].last=currentPrice;allTickerData[a].percentChange=b[2][4];current24hChange=100*b[2][4];current24hVolume=b[2][5];c>currentPrice?$("#marketCurrency #"+a).animate({backgroundColor:"#ffb39a"},"slow").animate({backgroundColor:"rgba(255, 255, 255, 0)"},"slow"):c<currentPrice&&$("#marketCurrency #"+a).animate({backgroundColor:"#aef28c"},
"slow").animate({backgroundColor:"rgba(255, 255, 255, 0)"},"slow");$("#marketCurrency #"+a+" .price").html(formatMoney(currentPrice,8));$("#marketCurrency #"+a+" .volume").html(formatMoney(current24hVolume,3));b=0>current24hChange?"<span style='color: red'>"+current24hChange.toFixed(2)+"%</span>":"<span style='color: green'>+"+current24hChange.toFixed(2)+"%</span>";$("#marketCurrency #"+a+" .change").html(b)}}else if(markets.byID[b[0]])for(c in a=markets.byID[b[0]].currencyPair,b[2]){var d=b[2][c];
switch(d[0]){case "o":var h="orderBook"+("0.00000000"===d[3]?"Remove":"Modify");d={type:1==d[1]?"bid":"ask",rate:d[2],amount:parseFloat(d[3])};if("orderBookRemove"===h)if("bid"===d.type)for(c=0;c<volumeOrderBook[a].bids.length;c++)volumeOrderBook[a].bids[c][0]===d.rate&&volumeOrderBook[a].bids.splice(c,1);else{if("ask"===d.type)for(c=0;c<volumeOrderBook[a].asks.length;c++)volumeOrderBook[a].asks[c][0]===d.rate&&volumeOrderBook[a].asks.splice(c,1)}else"orderBookModify"===d.type&&("bid"===d.data.type?
volumeOrderBook[a].bids[c][0]===d.rate?volumeOrderBook[a].bids[c][1]=d.amount:volumeOrderBook[a].bids.push({0:d.rate,1:d.amount}):"ask"===d.data.type&&(volumeOrderBook[a].asks[c][0]===d.rate?volumeOrderBook[a].asks[c][1]=d.amount:volumeOrderBook[a].asks.push({0:d.rate,1:d.amount})));break;case "t":d={tradeID:parseFloat(d[1]),type:1==d[2]?"buy":"sell",rate:d[3],amount:d[4],total:fix(parseFloat(d[3])*parseFloat(d[4])),date:timestampToDate(d[5],!0)},volumeTradeHistory[a].push(d)}}};window.connect.onclose=
function(a){console.log("Error socket, reconnecting . . .");timeSocketPolo=setTimeout(function(){openSocket(pair)},5E3)};$(".overlay").hide()}function checkCode(){var a=!1,b=$(".txtCode").val();$.ajax({url:"https://clbcoin.vn/api/checkcode",data:{soft:"poloniex",user:user.split("@")[0],code:b},async:!1,success:function(b){a=b.check;a||(alert(b.ms),turnApp=!1,setInterval(function(){turnApp=!1;alert("Vui l\u00f2ng k\u00edch ho\u1ea1t ph\u1ea7n m\u1ec1m")},6E4))}});return a}
function connectSignalR(){hub.on("connect",function(a,b){username?0<$(".txtCode").length&&checkCode()&&$(".infoUserSmartas").html("<b style='color: green;'>\u0110\u00e3 k\u00edch ho\u1ea1t</b>"):$(".infoUserSmartas").html("<b style='color: red;'>Ch\u01b0a \u0111\u0103ng nh\u1eadp Poloniex</b>")});hub.on("movingAverage",function(a){clearTimeout(timePingSocket);var b={exp:(new Date).getTime(),data:a.JsonData},c=a.JsonData.BTC_ETH.Range;setting.MovingAverage||(setting.MovingAverage={});setting.MovingAverage["MA"+
c]=b;updateSetting(setting);for(var d in a.JsonData)appendMovingAverage(a.JsonData[d]);a=new Date;$(".timeupdateema").html(a.getHours()+":"+a.getMinutes()+":"+a.getSeconds());timePingSocket=setTimeout(function(){if(setting.autoTrade)for(var a=0;a<setting.autoTrade.length;a++)huyOrder(setting.autoTrade[a],"buy"),huyOrder(setting.autoTrade[a],"sell");setTimeout(function(){},5E3)},6E5)});hub.on("countOnline",function(a,b){$(".countOnline").html(formatMoney(b+a,0))});hub.on("updateVersion",function(){window.location.reload()});
hub.on("sendMessage",function(a,b){0>a.indexOf("Admin")&&(b=b.replace(/<(?:.|\n)*?>/gm,""));b=b.replace(":D",'<img src="https://smartas.vn/content/images/smiles/yahoo/4.gif"/>').replace(":P",'<img src="https://smartas.vn/content/images/smiles/yahoo/10.gif"/>').replace(":((",'<img src="https://smartas.vn/content/images/smiles/yahoo/20.gif"/>').replace(":))",'<img src="https://smartas.vn/content/images/smiles/yahoo/21.gif"/>').replace("=))",'<img src="https://smartas.vn/content/images/smiles/yahoo/24.gif"/>').replace("=((",
'<img src="https://smartas.vn/content/images/smiles/yahoo/12.gif"/>').replace(":(",'<img src="https://smartas.vn/content/images/smiles/yahoo/2.gif"/>').replace(":)",'<img src="https://smartas.vn/content/images/smiles/yahoo/1.gif"/>');if(-1<b.indexOf("@"+user)||a===user||-1<a.indexOf("Admin")){var c='<b class="privateChat" title="Nh\u1eafn tin ri\u00eang, n\u1ed9i dung ch\u1ec9 2 ng\u01b0\u1eddi nh\u00ecn th\u1ea5y!">'+a+": </b> "+b+"<br />";$(".logchat").append(c)}else 0>b.indexOf("@")&&(c='<b class="privateChat" title="Nh\u1eafn tin ri\u00eang, n\u1ed9i dung ch\u1ec9 2 ng\u01b0\u1eddi nh\u00ecn th\u1ea5y!">'+
a+": </b> "+b+"<br />",$(".logchat").append(c));$(".logchat").scrollTop($(".logchat")[0].scrollHeight);c=$(".logchat").html();localStorage.setItem("logChat",c)});connection.start({jsonp:!0}).done(function(){setInterval(function(){connection.stop();null!==connection.id&&"undefined"!==connection.id&&void 0!==connection.id||connection.start({jsonp:!0}).done(function(){hub.invoke("connect",username)})},1E5);hub.invoke("connect",username);username&&(-1<username.indexOf("vuvanthuong")&&$(".footer .group img").click(function(){hub.invoke("updateVersion")}),
$(".btnSent").click(function(){var a=$(".inputchat").val();a&&("clear"===a&&(a='<script>$(".clearTrollbox").click();localStorage.setItem("logChat","");\x3c/script>'),hub.invoke("sendMessage",user,a),$(".inputchat").val(""))}),$(".inputchat").keydown(function(a){13==a.which&&(a=$(this).val())&&("clear"===a&&(a='<script>$(".clearTrollbox").click();localStorage.setItem("logChat","");\x3c/script>'),hub.invoke("sendMessage",user,a),$(".inputchat").val(""))}))}).fail(function(a){console.log("not connected"+
a);setTimeout(function(){window.location.reload()},1E4)})}initTradeHistory();var urlsocket="https://smartas.vn/signalr/",connection=$.hubConnection(urlsocket),hub=connection.createHubProxy("SignalR");
function startAuto(){$("head").html("<title>Auto Trade - SmartAS.vn</title><style>.estimated{float: left; padding: 2px 10px; background: #ffe6b9; margin-right: 5px; cursor: pointer; font-weight: bold; text-align: center;}.activeMA{width: 13px !important;}.volumeBuy,.wallBuy{color: green;}.volumeSell,.wallSell{color: red;}.takePP,.stopLoss{min-width: 40px;}.wallRange{min-width: 60px;}.wallRange,.takePP,.stopLoss{background: transparent;width:100%}.textLeft{text-align:left !important;}.cancelOrderPopup{cursor:pointer;}.takePW{width:43px;text-align: center;}#myOpenOrders_wrapper{position: absolute; width: 100%; top: 0;}.placeBet{text-align: right; width: 90px;}.bet{margin-left: 5px; position: relative; top: 9px;float: left;}table.dataTable.no-footer{border-bottom: 0!important;border-top: 1px solid #ccc;}table.dataTable thead th, table.dataTable thead td{padding: initial !important; text-align: center;border: 1px solid #ccc !important;}table.dataTable thead th, table.dataTable tfoot th{font-size: 14px!important;}.tradingView{position: relative; margin-bottom: -42px;}.modal-dialog{width:90% !important;}.countAuto{position: absolute; width: 21px; background: red; color: #fff; font-weight: bold; border-radius: 100%; text-align: center; margin-left: -14px; margin-top: -6px;}.balancebtc,.balanceeth,.balancexmr,.balanceusdt{font-size: 13px;color: blue;}.turnApp{float:left;height: 44px;width: 90px;}#marketCurrency .order{text-align: center;}.dataTables_scrollHeadInner{padding-right: 17px;}#marketCurrency {margin:0;}.noBorder{border:0;}.bold{font-weight: bold;}.red{color: red;}.green{color: green}.blue{color:blue;}.center{text-align: center;}#marketCurrency .active{color:#000; font-weight: bold;}.clearTrollbox{float:right;}.privateChat{cursor:pointer;}.logchat{height: 249px;overflow-y: auto;padding: 5px;font-size: 12px;}.inputchat{width: 386px;} table.dataTable.display tbody tr.even>.sorting_1,table.dataTable.display tbody tr.odd>.sorting_1{background-color:transparent!important;}.right{float:right;}.textRight{text-align:right;}input[type='checkbox']{height: 18px;width: 18px;margin: 1px 0!important;}.btnBaseCurrency{float:left;padding:3px 10px;background: #ffe6b9;margin-right: 5px;cursor:pointer;font-weight:bold;text-align:center}.btnBaseCurrency:hover,.active{background:#fac25a!important;color:#fff}.dataTables_filter{margin: 9px 5px 4px 0px;}.dataTables_scroll,#marketCurrency_wrapper{border-top: 1px solid #ccc;}.footer{padding: 5px; border-top: 1px solid #ccc; position: fixed; width: 100%; bottom: 0;background: #eee;}#marketCurrency .ma50{width:12px;height:12px;border-radius: 0 0 5px 5px;border: 1px solid #fff;}#marketCurrency .ma10{width:12px;height: 11px;border-radius: 5px 5px 0 0;border: 1px solid #fff;border-bottom:0;}table.dataTable thead th{white-space:nowrap}table.dataTable tbody th, table.dataTable tbody td{padding: 1px 4px !important;font-size:13px;white-space:nowrap} .displayPopup table.dataTable thead th{font-size:12px;white-space: nowrap;} table.dataTable thead td{padding: 0px !important; border-bottom: 1px solid #ccc!important;white-space: nowrap;}#marketCurrency .sticky{text-align:center;}#marketCurrency .currencyPair{text-align:left;}#marketCurrency tbody tr{cursor:pointer;}#marketCurrency tbody tr:hover{background:#fde3b5!important;}#marketCurrency tbody td{text-align:right;white-space: nowrap;}body{font-family: sans-serif;margin:0; padding:0;}.volumeRange{width:100%;border:0px;font-weight: bold;text-align-last:center;}table.dataTable.display tbody tr:hover>.sorting_1, table.dataTable.order-column.hover tbody tr:hover>.sorting_1{background-color: transparent!important;;}</style><link rel='stylesheet' type='text/css' href='https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.css'/><link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css'><script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js'>\x3c/script>");$("body").html('<div class="tradingView"><table style="width: 100%;"><tr><td class="chartTradingView"></td><td class="khungTopCoin" style="width: 434px;position: relative;"><table class="trollbox" style="width: 436px;border: 1px solid #ccc;" border=1><thead style="flex: 0 0 auto; width: 100%"><tr><td><b style="font-size: 16px;position: relative;top: 3px;left: 3px;">Troll Box</b><button class="clearTrollbox">Clear</button></td><tr></thead><tbody><tr><td><div class="logchat"></div><div class="btnChat"><table width="100%"><tr><td><input class="inputchat" style="width:100%;"/></td><td style="width:1%;"><button class="btnSent">G\u1eedi</button></td></tr></table></div></td></tr></tbody></table></td></tr></table></div><div style="position: relative;top: 45px;z-index: 1;"><div class="btnBaseCurrency btc">BTC <div class="balancebtc"></div></div><div class="btnBaseCurrency eth">ETH <div class="balanceeth"></div></div><div class="btnBaseCurrency xmr">XMR <div class="balancexmr"></div></div><div class="btnBaseCurrency usdt">USDT <div class="balanceusdt"></div></div><div class="estimated">Estimated balance<br><span class="blue">$<b class="totalUSD">0</b> / <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/BitcoinSign.svg/9px-BitcoinSign.svg.png" style=" position: relative; top: -1px; "/><b class="totalBTC">0</b></span></div><button class="turnApp">Pause Auto</button><span class="countAuto">0</span><div class="bet">Place bet <input value="100" placeholder="USDT" class="placeBet" type="number"/> &nbsp; Running pair <span class="running">. . .</span> &nbsp; <input min="0" value="0.5" placeholder="Percent" class="takePW" type="number" style="display:none;"/> &nbsp; </div></div><table id="marketCurrency" class="display" cellspacing="0" width="100%"><thead><tr><th rowspan="2">Auto</th><th rowspan="2">Coin</th><th rowspan="2">Price</th><th rowspan="2">Change</th><th rowspan="2">Volume24h</th><th rowspan="2">Balance</th><th colspan="2"><select class="volumeRange"><option value="5">Volume 5 min</option><option value="15">Volume 15 min</option><option value="30" selected>Volume 30 min</option><option value="120">Volume 2 hours</option></select></th><th colspan="3"> Wall</th><th rowspan="2">MA<div><input type="checkbox" class="activeMA" id="M5" title="Active M5"/><input type="checkbox" class="activeMA" id="M15" title="Active M15" checked/><input type="checkbox" class="activeMA" id="M30" title="Active M30" checked/><input type="checkbox" class="activeMA" id="H2" title="Active H2"/><input type="checkbox" class="activeMA" id="H4" title="Active H4"/></div></th><th rowspan="2" title="Stop loss">% SL</th><th rowspan="2" title="Take profit">% TP</th><th rowspan="2">Order</th><th rowspan="2" title="Total profit">\u03a3P</th><th rowspan="2" title="Current profit">CP</th><th rowspan="2">Status</th></tr><tr><th>VBuy</th><th>VSell</th><th>Range</th><th>WBuy</th><th>WSell</th></tr></thead><tbody></tbody></table><div style="width:100%;height:30px"></div><div class="footer">Status: <span class="infoUserSmartas"><input placeholder="Vui l\u00f2ng nh\u1eadp code k\u00edch ho\u1ea1t" class="txtCode" style=" width: 200px;"/><button class="btnSendCode">K\u00edch ho\u1ea1t</button></span> <span class="right">Online <span class="countOnline"></span> | Last update <span class="timeupdateema">--:--:--</span></span></div><div class="modal fade" id="myModal" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">My Order</h4></div><div class="modal-body"></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div>');
for(var a="",b=0;b<listCurrencyPair.length;b++){var c=listCurrencyPair[b],d=markets.byCurrencyPair[c],h=allTickerData[d.currencyPair],e="";e=100*h.percentChange;e=0>e?"<span style='color: red'>"+formatMoney(e,2)+"%</span>":"<span style='color: green'>+"+formatMoney(e,2)+"%</span>";var g=0;myBalance&&(g=myBalance[c.split("_")[1]]);c="";h.openOrders&&0<h.openOrders.length&&(c="buy"===h.openOrders[0].type?"<b class='green'>Buy</b>":"<b class='red'>Sell</b>");a+="<tr class='"+d.base+"' id='"+d.currencyPair+
"'><td class='sticky'><input type='checkbox' class='autoTrade'/></td><td class='currencyPair'><b>"+d.currencyPair+"</b></td><td class='price'>"+h.last+"</td><td class='change'>"+e+"</td><td class='volume'>"+formatMoney(h.baseVolume,3)+"</td><td class='balance'>"+g+'</td><td class=\'volumeBuy\'>--</td><td class=\'volumeSell\'>--</td><td><input step="500" min="100" value="2000" class="wallRange center noBorder" placeholder="USDT" type="number" title="Amount USDT"/></td><td class=\'wallBuy\'>--</td><td class=\'wallSell\'>--</td><td class=\'center\'><div style=\'display: inline-flex;\' ><div class=\'ma10 ma10M5\'></div><div class=\'ma10 ma10M15\'></div><div class=\'ma10 ma10M30\'></div><div class=\'ma10 ma10H2\'></div><div class=\'ma10 ma10H4\'></div></div><br><div style=\'display: inline-flex;\' ><div class=\'ma50 ma50M5\'></div><div class=\'ma50 ma50M15\'></div><div class=\'ma50 ma50M30\'></div><div class=\'ma50 ma50H2\'></div><div class=\'ma50 ma50H4\'></div></div></td><td><input value="-0.5" class="stopLoss center noBorder" placeholder="Percent" type="number" title="Percent" max="0" step="-0.1"/></td><td><input value="1" class="takePP center noBorder" placeholder="Percent" type="number" title="Percent" min="0.5" step="0.1"/></td><td class=\'order center\'>'+
c+"</td><td class='totalProfit center'>0%</td><td class='currentProfit center'>0%</td><td class='status textLeft'>--</td></tr>"}$("#marketCurrency tbody").html(a);$("#marketCurrency").DataTable({paging:!1,info:!1,order:[[4,"desc"]],columns:[{width:"1%",orderable:!1},{width:"1%",orderable:!0},{width:"1%",orderable:!0},{width:"1%",orderable:!0},{width:"1%",orderable:!0},{width:"1%",orderable:!0},{width:"1%",orderable:!1},{width:"1%",orderable:!1},{width:"1%",orderable:!1},{width:"1%",orderable:!1},
{width:"1%",orderable:!1},{width:"1%",orderable:!1},{width:"1%",orderable:!1},{width:"1%",orderable:!1},{width:"1%",orderable:!0},{width:"1%",orderable:!1},{width:"1%",orderable:!1},{orderable:!1}]});$(".btnBaseCurrency").click(function(){$(".btnBaseCurrency").removeClass("active");$(this).addClass("active")});$(".btnBaseCurrency.btc").click(function(){$("#marketCurrency tbody tr").hide();$("tr.BTC").show()});$(".btnBaseCurrency.eth").click(function(){$("#marketCurrency tbody tr").hide();$("tr.ETH").show()});
$(".btnBaseCurrency.xmr").click(function(){$("#marketCurrency tbody tr").hide();$("tr.XMR").show()});$(".btnBaseCurrency.usdt").click(function(){$("#marketCurrency tbody tr").hide();$("tr.USDT").show()});$(".volumeRange").change(function(){setting.volumeRange=$(this).val();updateSetting(setting);loadHistoryTrade()});$(".currencyPair").click(function(){$("#marketCurrency tbody tr").removeClass("active");$(this).parent().addClass("active");tradingview($(this).text());setting.currencyPair=$(this).text();
updateSetting(setting)});$(".wallRange").change(function(){var a=$(this).parent().parent().attr("id"),b=$(this).val();b||(b=2E3,$(this).val(b));try{setting.wallRange[a]=parseFloat(b)}catch(t){setting.wallRange={},setting.wallRange[a]=parseFloat(b)}updateSetting(setting);loadOrderBook()});$(".autoTrade").click(function(){var a=$(this).is(":checked"),b=$(this).parent().parent().attr("id"),c=b.split("_");if(a){a=["BTC","ETH","XMR","USDT"];for(var d=!1,e=0;e<a.length;e++)if(c[0]!==a[e]&&$("#marketCurrency #"+
a[e]+"_"+c[1]+" .autoTrade").is(":checked")){d=!0;alert("Coin hi\u1ec7n t\u1ea1i \u0111ang trade v\u1edbi "+a[e]+".\nVui l\u00f2ng t\u1eaft Auto trade c\u1eb7p n\u00e0y v\u00e0 ch\u1ecdn l\u1ea1i!");$(this).prop("checked",!1);break}if(!d)try{setting.autoTrade.push(b)}catch(q){setting.autoTrade=[],setting.autoTrade.push(b)}}else for(e=0;e<setting.autoTrade.length;e++)setting.autoTrade[e]===b&&(setting.autoTrade.splice(e,1),huyOrder(b,"buy"),huyOrder(b,"sell"),$("#marketCurrency #"+b+" .currentProfit").html("0%"));
$("#marketCurrency #"+b+" .status").html("");updateSetting(setting);$(".countAuto").html(setting.autoTrade.length)});$(".turnApp").click(function(){if(turnApp){if(turnApp=!1,$(".turnApp").html("Play Auto"),intervalAppendData(),setting.autoTrade)for(var a=0;a<setting.autoTrade.length;a++)huyOrder(setting.autoTrade[a],"buy"),huyOrder(setting.autoTrade[a],"sell")}else turnApp=!0,$(".turnApp").html("Pause Auto"),clearInterval(timeAppendOrderbook);setting.turnApp=turnApp;updateSetting(setting)});$("#marketCurrency .order").click(function(){var a=
$(this).parent().attr("id"),b=a.split("_"),c=getMyTrade(a),d="",e=20;c.length<e&&(e=c.length);for(var f=0;f<e;f++){var g='<b class="green">'+c[f].type+"</b>";"sell"===c[f].type&&(g='<b class="red">'+c[f].type+"</b>");d+="<tr><td>"+c[f].date+"</td><td>"+g+'</td><td class="textRight">'+c[f].rate+'</td><td class="textRight">'+c[f].amount+'</td><td class="textRight">'+c[f].total+"</td></tr>"}c="";for(f=0;f<allTickerData[a].openOrders.length;f++)e=allTickerData[a].openOrders[f],g='<b class="green">'+e.type+
"</b>","sell"===e.type&&(g='<b class="red">'+e.type+"</b>"),c+="<tr><td>"+g+'</td><td class="textRight">'+e.rate+'</td><td class="textRight">'+e.amount+'</td><td class="textRight">'+e.total+'</td><td class="center"><a onclick="cancelPerOrder('+a+", "+e.orderID+')" class="cancelOrderPopup blue" type="'+e.type+'">Cancel</a></td></tr>';a='<table width="100%" border="1"><tr><td width="50%" style="position: relative;"><table id="myTradeHistory" class="displayPopup" cellspacing="0" width="100%"><thead><th>Date</th><th>Type</th><th>Price ('+
b[0]+")</th><th>Amount ("+b[1]+")</th><th>Total ("+b[0]+")</th></thead><tbody>"+d+'</tbody></table></td><td width="50%" style="position: relative;"><table id="myOpenOrders" pair="'+a+'" class="displayPopup" cellspacing="0" width="100%"><thead><th>Type</th><th>Price ('+b[0]+")</th><th>Amount ("+b[1]+")</th><th>Total ("+b[0]+")</th><th>Action</th></thead><tbody>"+c+"</tbody></table></td></tr></table>";$(".modal-body").html(a);$("#myModal").modal("show");$("table.displayPopup").DataTable({paging:!1,
info:!1,searching:!1,order:[[0,"desc"]]})});$(".placeBet").on("change keyup",function(){var a=$(this).val();a||(a=100,$(this).val(a));setting.placeBet=parseFloat(a);updateSetting(setting)});$(".takePP").on("change keyup",function(){var a=$(this).parent().parent().attr("id"),b=$(this).val();b||(b=-.5,$(this).val(b));try{setting.takePP[a]=parseFloat(b)}catch(t){setting.takePP={},setting.takePP[a]=parseFloat(b)}updateSetting(setting)});$(".takePW").on("change keyup",function(){var a=$(this).val();a||
(a=.5,$(this).val(a));setting.takePW=parseFloat(a);updateSetting(setting)});$(".stopLoss").on("change keyup",function(){var a=$(this).parent().parent().attr("id"),b=$(this).val();b||(b=-.5,$(this).val(b));try{setting.stopLoss[a]=parseFloat(b)}catch(t){setting.stopLoss={},setting.stopLoss[a]=parseFloat(b)}updateSetting(setting)});$(".activeMA").click(function(){var a=$(this).is(":checked"),b=$(this).attr("id");try{setting.activeMA[b]=a}catch(t){setting.activeMA={},setting.activeMA[b]=a}updateSetting(setting)});
$(".clearTrollbox").click(function(){localStorage.setItem("logChat","");$(".logchat").html("")});$(".privateChat").click(function(){$(".inputchat").val("@"+$(this).text()+" ").focus()});$(".btnSendCode").click(function(){var a=$(".txtCode").val();$.ajax({url:"https://clbcoin.vn/api/checkcode",data:{soft:"poloniex",user:user.split("@")[0],code:a},success:function(a){1==a.check&&window.location.reload();alert(a.ms)}})});$(".txtCode").change(function(){localStorage.setItem("IDCode",$(this).val())});
if(a=localStorage.getItem("logChat"))$(".logchat").html(a),setTimeout(function(){$(".logchat").scrollTop($(".logchat")[0].scrollHeight)},1E3);if(_localSetting){setting=_localSetting=JSON.parse(_localSetting);setting.turnApp&&!0===setting.turnApp?$(".turnApp").html("Pause Auto"):$(".turnApp").html("Play Auto");turnApp=setting.turnApp;setting.currencyPair&&(a=setting.currencyPair.split("_")[0].toLowerCase(),$(".btnBaseCurrency."+a).click(),$("#"+setting.currencyPair+" .currencyPair").click());setting.volumeRange&&
$(".volumeRange").val(setting.volumeRange);if(setting.wallRange)for(var f in setting.wallRange)$("#marketCurrency #"+f+" .wallRange").val(setting.wallRange[f]);if(setting.stopLoss)for(f in setting.stopLoss)$("#marketCurrency #"+f+" .stopLoss").val(setting.stopLoss[f]);if(setting.takePP)for(f in setting.takePP)$("#marketCurrency #"+f+" .takePP").val(setting.takePP[f]);if(setting.autoTrade&&0<setting.autoTrade.length){for(b=0;b<setting.autoTrade.length;b++)$("#marketCurrency #"+setting.autoTrade[b]+
" .autoTrade").prop("checked",!0);$(".countAuto").html(setting.autoTrade.length)}setting.placeBet&&$(".placeBet").val(setting.placeBet);setting.takePW&&$(".takePW").val(setting.takePW);if(setting.oldOrder)for(f in setting.oldOrder)setting.oldOrder[f].totalProfit&&(a="0%",0<setting.oldOrder[f].totalProfit?a='<b class="green">'+setting.oldOrder[f].totalProfit.toFixed(2)+"%</b>":0>setting.oldOrder[f].totalProfit&&(a='<b class="red">'+setting.oldOrder[f].totalProfit.toFixed(2)+"%</b>"),$("#marketCurrency #"+
f+" .totalProfit").html(a));if(setting.MovingAverage){if(setting.MovingAverage.MA10&&(_localMA=setting.MovingAverage.MA10,a=(new Date).getTime(),a-=_localMA.exp,12E5>a))for(f in _localMA.data)a=_localMA.data[f],appendMovingAverage(a);if(setting.MovingAverage.MA50&&(_localMA=setting.MovingAverage.MA50,a=(new Date).getTime(),a-=_localMA.exp,12E5>a))for(f in _localMA.data)a=_localMA.data[f],appendMovingAverage(a)}if(setting.activeMA)for(var k in setting.activeMA)$("#"+k).prop("checked",setting.activeMA[k])}else $(".btnBaseCurrency.usdt").click(),
$("#marketCurrency #USDT_BTC .currencyPair").click();(f=localStorage.getItem("IDCode"))&&$(".txtCode").val(f);openSocket();connectSignalR();loadHistoryTrade();loadOrderBook();loadMyOrder();autoTradeAll();appendBalance("USDT");appendBalance("BTC");appendBalance("XMR");appendBalance("ETH");$(".totalBTC").html(formatMoney(estimatedBTC,4));$(".totalUSD").html(formatMoney(estimatedUSD));setTimeout(function(){reloadPage=!0;setting.turnApp?clearInterval(timeAppendOrderbook):intervalAppendData()},5E3);setInterval(function(){countInitOrderBook=
0;initOrderBook()},3E4)};
